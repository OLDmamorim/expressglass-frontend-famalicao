/* ========== BASE ========== */
* { box-sizing: border-box; }
html, body { max-width: 100vw; overflow-x: hidden; }
body { font-family: Arial, Helvetica, sans-serif; margin: 20px; background:#f6f7fb; color:#1f2937; }

/* Header */
.page-header{ position:relative; background:linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%); color:#fff; padding:20px; border-radius:12px; margin-bottom:18px; }
.page-header h1{ margin:0; font-size:28px; font-weight:800; text-align:center }
.subtitle{ margin:4px 0 10px; text-align:center; color:#e5edff }
.header-actions{ position:absolute; top:14px; right:16px; display:flex; gap:8px }
.header-btn{ background:rgba(255,255,255,.2); border:1px solid rgba(255,255,255,.3); color:#fff; padding:8px 12px; border-radius:8px; cursor:pointer; }
.connection-status{ display:flex; gap:6px; align-items:center; background:rgba(255,255,255,.15); border:1px solid rgba(255,255,255,.25); padding:6px 10px; border-radius:8px; font-size:12px; }

/* NAV */
.nav-bar{ display:flex; align-items:center; gap:10px; margin:12px 0; flex-wrap:wrap; }
.nav-left,.nav-right{ display:flex; gap:10px; }
.week-range{ flex:1; text-align:center; font-weight:600; color:#374151; }
.nav-button{ background:#fff; border:1px solid #e5e7eb; border-radius:8px; padding:8px 12px; cursor:pointer; }

/* SEARCH */
.search-bar{ background:#f8fafc; border:1px solid #e2e8f0; padding:12px 16px; border-radius:10px; display:flex; gap:10px; align-items:center; margin-bottom:12px; }
.search-bar.hidden{ display:none; }
#searchInput{ flex:1; padding:10px 14px; border:1px solid #d1d5db; border-radius:8px; outline:none; }
#searchInput:focus{ border-color:#3b82f6; box-shadow:0 0 0 3px rgba(59,130,246,.1); }
.search-clear{ background:#ef4444; color:#fff; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; }

/* ========== CALENDÁRIO ========== */
.schedule-container{ background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:0; box-shadow:0 2px 4px rgba(0,0,0,.04); }
table.schedule{ width:100%; border-collapse:collapse; table-layout:fixed; }
table.schedule thead th{ background:#f9fafb; text-align:center; font-weight:700; border-bottom:1px solid #e5e7eb; line-height:1.2; padding:10px 6px; }
table.schedule th .day{ font-size:16px; color:#374151; }
table.schedule th .date{ font-size:12px; color:#6b7280; }
table.schedule th:first-child{ width:90px; text-align:left; }
table.schedule tbody th{ background:#f9fafb; text-align:left; padding:14px 10px; font-weight:700; color:#374151; width:90px; }
table.schedule td{ min-height:120px; border-left:1px solid #e5e7eb; border-bottom:1px solid #e5e7eb; vertical-align:top; padding:8px; }
table.schedule td:first-child{ border-left:none; }

/* Drop zones */
.drop-zone{ min-height:70px; border:2px dashed transparent; border-radius:10px; padding:4px; transition:all .2s ease; }
.drop-zone.drag-over{ border-color:#3b82f6; background:rgba(59,130,246,.08); }

/* ========== CARTÕES (Calendário + Por Agendar) ========== */
.appointment-block{
  position:relative;
  border-radius:20px;
  padding:14px 16px 46px;          /* espaço para ações no rodapé */
  margin-bottom:12px;
  box-shadow:0 10px 24px rgba(0,0,0,.12);
  border:none;
  transition:transform .15s ease, box-shadow .15s ease;
  color:#fff;
}
.appointment-block:hover{ transform: translateY(-1px); box-shadow:0 14px 28px rgba(0,0,0,.18); }
.appt-header{ font-weight:800; letter-spacing:.2px; margin-bottom:4px; color:inherit; }
.appt-sub{ font-size:12px; opacity:.95; color:inherit; }

/* Cores por ESTADO (fundo do cartão) */
.appointment-block.status-NE{ background:linear-gradient(180deg,#fca5a5,#ef4444) !important; color:#fff; }
.appointment-block.status-VE{ background:linear-gradient(180deg,#fde68a,#f59e0b) !important; color:#111 !important; }
.appointment-block.status-ST{ background:linear-gradient(180deg,#6ee7b7,#10b981) !important; color:#fff; }

/* ========== ESTADOS (N/E, V/E, ST) ========== */
.appt-status{ display:flex; flex-wrap:wrap; column-gap:8px; row-gap:6px; margin-top:8px; }
.appt-status label{ display:inline-flex; align-items:center; gap:8px; padding:4px 10px; border-radius:999px; background:rgba(255,255,255,.18); border:1px solid rgba(255,255,255,.28); color:#fff; font-weight:800; font-size:12px; }
.appt-status label:has(input[type="checkbox"]:checked){
  background:rgba(0,0,0,.20);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.25), inset 0 -10px 18px rgba(0,0,0,.18);
  transform: translateY(-1px);
}

/* Checkbox compacta com visto PRETO */
.appt-status input[type="checkbox"]{
  -webkit-appearance:none; appearance:none;
  width:18px; height:18px; border-radius:6px; background:#fff; border:2px solid #9ca3af;
  display:grid; place-content:center; box-shadow:0 1px 0 rgba(0,0,0,.06), inset 0 0 0 1px rgba(255,255,255,.6);
  transition:border-color .12s ease, transform .08s ease;
}
.appt-status input[type="checkbox"]::after{
  content:""; width:8px; height:5px; border:2.5px solid transparent;
  border-left-color:#111827; border-bottom-color:#111827;
  transform:rotate(-45deg) scale(0); transform-origin:center; transition:transform .12s ease;
}
.appt-status input[type="checkbox"]:checked{ border-color:#111827; }
.appt-status input[type="checkbox"]:checked::after{ transform:rotate(-45deg) scale(1); }

/* ========== AÇÕES (Editar/Apagar) nos cartões ========== */
.card-actions{ position:absolute; left:10px; bottom:8px; display:flex; gap:8px; z-index:5; }
.card-actions button, .card-actions .action,
.appointment-block [title="Editar"], .appointment-block [aria-label="Editar"],
.appointment-block [title="Apagar"], .appointment-block [aria-label="Apagar"]{
  height:32px; min-width:40px; padding:4px 8px; border-radius:8px;
  background:#f8fafc; border:1px solid #e5e7eb; color:#0f172a !important;
  font-weight:700; font-size:13px; display:inline-flex; align-items:center; justify-content:center;
  box-shadow:0 2px 0 rgba(2,6,23,.05), inset 0 0 0 1px rgba(255,255,255,.6);
  transition:transform .12s ease, box-shadow .12s ease, background .12s ease; cursor:pointer;
}
.card-actions button:hover, .card-actions .action:hover,
.appointment-block [title="Editar"]:hover, .appointment-block [title="Apagar"]:hover{
  background:#eef2ff; transform:translateY(-1px); box-shadow:0 6px 16px rgba(2,6,23,.12);
}

/* ========== POR AGENDAR (mesmo look/tamanho dos cartões) ========== */
.unscheduled-container{ background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:14px; margin:16px 0 22px; box-shadow:0 6px 16px rgba(2,6,23,.06); }
.unscheduled-container h3{ margin:4px 0 10px; }
.unscheduled-actions{ display:flex; gap:10px; align-items:center; justify-content:space-between; margin-bottom:10px; }
.action-btn{ padding:10px 16px; border:none; border-radius:8px; cursor:pointer; }
.action-btn.primary{ background:#3b82f6; color:#fff; }

.unscheduled-list{
  display:grid;
  grid-template-columns: repeat(auto-fill, 280px);  /* colunas fixas = cartões iguais ao calendário */
  gap:12px;
  justify-content:flex-start;
  align-items:start;
}
.unscheduled-list .appointment-block{ width:280px; } /* garante largura idêntica */

/* ========== TABELA “SERVIÇOS A REALIZAR” ========== */
.services-table-container{ background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:20px; margin:22px 0 30px; box-shadow:0 2px 4px rgba(0,0,0,.04); }
.services-summary{ display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
.export-btn{ background:#10b981; color:#fff; border:none; padding:8px 14px; border-radius:8px; cursor:pointer; }
.services-table{ width:100%; border-collapse:collapse; }
.services-table th,.services-table td{ border-bottom:1px solid #eee; padding:10px 8px; font-size:14px; }
.services-table thead th{ background:#f9fafb; font-weight:700; }

/* ========== TOAST ========== */
.toast-container{ position:fixed; top:20px; right:20px; z-index:2000; }
.toast{ background:#fff; border:1px solid #e5e7eb; border-radius:10px; padding:12px 16px; margin-bottom:8px; box-shadow:0 4px 6px -1px rgba(0,0,0,.1); display:flex; gap:8px; min-width:280px; }
.toast.success{ border-left:4px solid #10b981; } .toast.error{ border-left:4px solid #ef4444; } .toast.info{ border-left:4px solid #3b82f6; }
.hidden{ display:none !important; }

/* ========== RESPONSIVO ========== */
.mobile-day-container{ display:none !important; }            /* evita “barras amarelas” no desktop */
@media (max-width: 820px){
  body{ margin:12px; }
  .mobile-day-container{ display:block !important; }
  .header-actions{ position:static; justify-content:center; margin-top:8px; }
  .page-header{ padding-top:16px; }
  .unscheduled-list{ grid-template-columns: 1fr; }          /* uma coluna no mobile */
}

/* ========== IMPRESSÃO ========== */
.print-unscheduled-section,
.print-today-section,
.print-tomorrow-section{ display:none !important; }          /* escondidas no ecrã */

@media print{
  body{ margin:0; background:#fff; }
  .header-actions, .search-bar, .unscheduled-actions, .mobile-day-container, .export-btn, .no-print { display:none !important; }
  .nav-bar{ display:none !important; }
  .appt-status{ display:none !important; }
  .form-container, .unscheduled-container{ display:none !important; }

  .print-page-1{ page-break-after: always; }
  .print-page-2{ page-break-before: always; }
  .print-page-3{ page-break-before: always; }

  .print-unscheduled-section,
  .print-today-section,
  .print-tomorrow-section{ display:block !important; margin:0; padding:20px; }

  .print-unscheduled-table,
  .print-today-table,
  .print-tomorrow-table{ width:100%; border-collapse:collapse; font-size:12px; }
  .print-unscheduled-table th, .print-unscheduled-table td,
  .print-today-table th, .print-today-table td,
  .print-tomorrow-table th, .print-tomorrow-table td{ border:1px solid #000; padding:8px; text-align:left; }
  .print-unscheduled-table th,
  .print-today-table th,
  .print-tomorrow-table th{ background:#f0f0f0; font-weight:700; text-align:center; }
}
/* ===== FIX: Botão "+ Novo Serviço" bonito ===== */
.unscheduled-actions .action-btn.primary {
  background: #2563eb;
  color: #fff;
  border: none;
  padding: 10px 16px;
  border-radius: 10px;
  font-weight: 700;
  box-shadow: 0 8px 18px rgba(37,99,235,.25);
  transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
}
.unscheduled-actions .action-btn.primary:hover {
  background:#1d4ed8;
  transform: translateY(-1px);
  box-shadow: 0 10px 22px rgba(37,99,235,.30);
}

/* ===== FIX: Modal estilizado e responsivo ===== */
.modal{
  display:none;
  position:fixed; inset:0;
  z-index: 9999;
  background: rgba(15, 23, 42, .55);
  backdrop-filter: blur(3px);
  align-items: center; justify-content: center;
  padding: 24px;
}
.modal.show{ display:flex; }

.modal-content{
  width: min(760px, 96vw);
  background:#fff;
  border-radius:16px;
  overflow:hidden;
  border:1px solid #e5e7eb;
  box-shadow: 0 20px 50px rgba(2,6,23,.25);
}

.modal-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:14px 18px;
  background: linear-gradient(135deg,#3b82f6 0%, #1d4ed8 100%);
  color:#fff;
}
.modal-header h3{ margin:0; font-size:18px; font-weight:800; }
.close-btn{
  background: rgba(255,255,255,.15);
  border:1px solid rgba(255,255,255,.25);
  color:#fff; border-radius:8px; padding:6px 10px; cursor:pointer;
}
.close-btn:hover{ background: rgba(255,255,255,.3); }

/* Conteúdo do formulário */
.appointment-form{ padding:18px; }
.form-row{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
@media (min-width: 820px){
  .form-row{ grid-template-columns: repeat(4, 1fr); }
}
.form-group{ display:flex; flex-direction:column; }
.form-group label{ font-weight:600; color:#111827; margin-bottom:6px; font-size:14px; }
.form-group small.form-hint{ font-size:12px; color:#6b7280; margin-top:4px; }

/* Inputs 100% e confortáveis no mobile (evita zoom) */
.appointment-form input,
.appointment-form select,
.appointment-form textarea{
  width:100%;
  border:1px solid #cbd5e1;
  border-radius:10px;
  padding:10px 12px;
  font-size:16px;               /* 16px para evitar zoom iOS/Android */
  outline:none;
  background:#fff;
  transition: border-color .15s ease, box-shadow .15s ease;
}
.appointment-form textarea{ min-height:84px; resize:vertical; }
.appointment-form input:focus,
.appointment-form select:focus,
.appointment-form textarea:focus{
  border-color:#3b82f6;
  box-shadow: 0 0 0 3px rgba(59,130,246,.12);
}

/* Ações do formulário alinhadas à direita */
.form-actions{
  display:flex; gap:10px; justify-content:flex-end;
  margin-top:16px; padding-top:12px; border-top:1px solid #e5e7eb;
}
.btn{
  border:none; border-radius:10px; padding:10px 16px;
  font-weight:700; cursor:pointer;
  transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
}
.btn.primary{ background:#2563eb; color:#fff; }
.btn.primary:hover{ background:#1d4ed8; transform: translateY(-1px); box-shadow:0 8px 18px rgba(37,99,235,.25); }
.btn.secondary{ background:#6b7280; color:#fff; }
.btn.secondary:hover{ background:#4b5563; transform: translateY(-1px); }
.btn.danger{ background:#ef4444; color:#fff; }
.btn.danger:hover{ background:#dc2626; transform: translateY(-1px); }

/* Campos largos (Observações/Outros) ocupam a linha toda */
.form-group[style*="grid-column: 1 / -1;"],
#appointmentNotes, #appointmentExtra{
  grid-column: 1 / -1;
}
/* =========================
   MODAL — Expressglass clean
   ========================= */
.modal {
  display: none;
  position: fixed; inset: 0;
  background: rgba(15, 23, 42, 0.55);
  backdrop-filter: blur(3px);
  z-index: 9999;
  align-items: center; justify-content: center;
  padding: 24px;
}
.modal.show { display: flex; }

.modal-content {
  width: min(720px, 95vw);
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 20px 50px rgba(2,6,23,.25);
  border: none;
  overflow: hidden;
  animation: fadeIn .25s ease;
}
@keyframes fadeIn { from {opacity:0; transform:translateY(-10px);} to{opacity:1;transform:translateY(0);} }

/* Header */
.modal-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 18px;
  background: linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%);
  color: #fff;
}
.modal-header h3 {
  margin: 0; font-size: 18px; font-weight: 800;
}
.close-btn {
  background: rgba(255,255,255,.15);
  border: 1px solid rgba(255,255,255,.25);
  color: #fff;
  border-radius: 8px;
  padding: 6px 10px;
  cursor: pointer;
}
.close-btn:hover { background: rgba(255,255,255,.3); }

/* Formulário */
.appointment-form {
  padding: 20px;
  display: grid;
  gap: 14px;
}
.form-row {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 12px;
}
.form-group {
  display: flex; flex-direction: column;
}
.form-group label {
  font-weight: 600;
  margin-bottom: 4px;
  font-size: 14px;
  color: #111827;
}
.form-hint {
  font-size: 12px; color: #6b7280; margin-top: 4px;
}

/* Inputs bonitos */
.appointment-form input,
.appointment-form select,
.appointment-form textarea {
  border: 1px solid #cbd5e1;
  border-radius: 8px;
  padding: 10px 12px;
  font-size: 15px;
  outline: none;
  background: #fff;
  transition: border-color .15s ease, box-shadow .15s ease;
}
.appointment-form textarea { min-height: 80px; resize: vertical; }
.appointment-form input:focus,
.appointment-form select:focus,
.appointment-form textarea:focus {
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59,130,246,.12);
}

/* Campos largos ocupam linha inteira */
#appointmentNotes, #appointmentExtra {
  grid-column: 1 / -1;
}

/* Ações */
.form-actions {
  display: flex; gap: 10px; justify-content: flex-end;
  margin-top: 10px; padding-top: 12px;
  border-top: 1px solid #e5e7eb;
}
.btn {
  border: none; border-radius: 8px;
  padding: 10px 18px;
  font-weight: 600;
  cursor: pointer;
  transition: transform .12s ease, box-shadow .12s ease;
}
.btn.primary { background: #2563eb; color: #fff; }
.btn.primary:hover { background: #1d4ed8; transform: translateY(-1px); box-shadow:0 6px 14px rgba(37,99,235,.25); }
.btn.secondary { background: #6b7280; color: #fff; }
.btn.secondary:hover { background: #4b5563; }
.btn.danger { background: #ef4444; color: #fff; }
.btn.danger:hover { background: #dc2626; }
/* ===== MOBILE FIX PACK ===== */
@media (max-width: 820px){

  /* 1) trocamos grelha por vista diária */
  .schedule-container{ display:none !important; }
  .mobile-day-container{ display:block !important; margin-top:12px; }

  /* 2) header mais compacto e sem quebrar */
  .page-header{ padding:16px; border-radius:12px; }
  .page-header h1{ font-size:22px; line-height:1.1; }
  .subtitle{ font-size:12px; }

  .nav-bar{ gap:8px; }
  .nav-button{ padding:8px 10px; font-size:14px; }
  .week-range{ font-size:14px; }

  /* 3) lista diária — cartões 100% largura e compactos */
  #mobileDayList .appointment-block{
    width:100%;
    border-radius:16px;
    padding:12px 14px 40px; /* espaço pro editar/apagar */
    box-shadow:0 8px 20px rgba(0,0,0,.12);
  }
  #mobileDayList .appt-header{ font-size:16px; line-height:1.2; }
  #mobileDayList .appt-sub{ font-size:12px; opacity:.95; }

  /* 4) pills de estado pequenas e sem “estourar” */
  #mobileDayList .appt-status,
  .appointment-block .appt-status{
    gap:8px; margin-top:8px; flex-wrap:wrap;
  }
  #mobileDayList .appt-status label,
  .appointment-block .appt-status label{
    padding:4px 8px; border-radius:999px; font-size:12px;
    background: rgba(255,255,255,.18);
    border: 1px solid rgba(255,255,255,.25);
  }
  /* checkbox menor com visto preto (já tens classes .state-box, mas reforço tamanho no mobile) */
  #mobileDayList .appt-status input[type="checkbox"],
  .appointment-block .appt-status input[type="checkbox"]{
    width:18px; height:18px; border-radius:6px;
  }
  #mobileDayList .appt-status input[type="checkbox"]::after,
  .appointment-block .appt-status input[type="checkbox"]::after{
    width:8px; height:5px; border-width:2.5px;
  }

  /* 5) ações fixas no canto e menores */
  .card-actions{ left:8px; bottom:8px; gap:8px; }
  .card-actions button{ height:32px; min-width:40px; padding:4px 8px; font-size:13px; }

  /* 6) secções desktop fora do caminho */
  .unscheduled-container{ margin-top:12px; }
  .services-table-container{ display:none !important; }

  /* 7) garante que nada sangra pra fora do cartão */
  .appointment-block{ overflow:hidden; }
}

/* ===== DESKTOP pequenos (>= 821px) — evitar quebra feia nas cabeças da grelha */
@media (min-width: 821px){
  table.schedule thead th .day,
  table.schedule thead th .date{
    white-space:nowrap;
  }
}
/* Mobile: esconder "Serviços por Agendar" e o botão Imprimir */
@media (max-width: 820px){
  /* toda a secção Por Agendar */
  .unscheduled-container,
  #unscheduledList,
  #addServiceBtn,           /* botão + Novo Serviço dessa secção */
  .mobile-add-btn {         /* se existir o botão móvel de novo serviço */
    display: none !important;
  }

  /* botão/área de imprimir na barra */
  #printPage,
  .nav-right {              /* onde costuma estar o botão de imprimir */
    display: none !important;
  }

  /* por via das dúvidas, também escondo as versões de impressão no mobile */
  .print-unscheduled-section,
  .print-today-section,
  .print-tomorrow-section {
    display: none !important;
  }
}
/* Mobile: mostrar só a navegação diária (evita botões duplicados) */
@media (max-width: 820px){
  .nav-bar {            /* barra "Anterior | Hoje | Seguinte" da semana */
    display: none !important;
  }
  .mobile-day-container {
    display: block !important;
  }
  .mobile-day-header {   /* um bocadinho de respiro */
    margin-top: 8px;
  }
}
/* ================================
   IMPRESSÃO: apenas HOJE + AMANHÃ
   ================================ */
@media print {
  @page { size: A4 landscape; margin: 12mm; }

  body {
    background: #fff;
    margin: 0;
    padding: 0;
  }

  /* Esconder tudo que não seja impressão */
  .page-header,
  .nav-bar,
  .unscheduled-container,
  .services-table-container,
  .mobile-day-container,
  .search-bar,
  .header-actions,
  .action-btn,
  .filter-select,
  .no-print {
    display: none !important;
  }

  /* Mostrar só as secções de impressão HOJE + AMANHÃ */
  .print-unscheduled-section { display: none !important; }
  .print-today-section,
  .print-tomorrow-section {
    display: block !important;
    margin: 0 0 20px;
    page-break-after: always;
  }

  .print-title {
    text-align: center;
    margin-bottom: 10px;
  }

  table.print-today-table,
  table.print-tomorrow-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
  }

  table.print-today-table th,
  table.print-today-table td,
  table.print-tomorrow-table th,
  table.print-tomorrow-table td {
    border: 1px solid #000;
    padding: 6px 8px;
    text-align: left;
  }

  table.print-today-table th,
  table.print-tomorrow-table th {
    background: #f3f4f6;
    font-weight: bold;
    text-align: center;
  }
}
/* pequeno alinhamento para o botão abaixo da navegação */
.nav-add-service {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin: 10px 0 18px;
}